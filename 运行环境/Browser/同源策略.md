#### ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥
åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨ä¿æŠ¤ç”¨æˆ·æ•°æ®çš„ä¸€ç§å®‰å…¨è¡Œä¸ºï¼Œå½“æµè§ˆå™¨å‘ç°è¯·æ±‚çš„æœåŠ¡å™¨ä¸å½“å‰ç½‘ç«™çš„`åè®®`ã€`åŸŸå`ã€`ç«¯å£`ä»»æ„ä¸€ä¸ªä¸ç›¸åŒï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚

**ä»€ä¹ˆæ“ä½œä¼šè§¦å‘åŒæºç­–ç•¥**

- AJAXé€šä¿¡
- è·å–Coockie
- DOMæ“ä½œ
- è·å–localstorage

**é¿å¼€åŒæºç­–ç•¥çš„æ–¹æ³•**

- `CORS` è·¨åŸŸèµ„æºå…±äº«
- JSONP åˆ©ç”¨`script`çš„`src`æ²¡æœ‰è·¨åŸŸé™åˆ¶å®ç°
- å¼€å‘ç¯å¢ƒä¸‹`webpack`çš„`devserver`, çº¿ä¸Šç¯å¢ƒå¯ä»¥ä½¿ç”¨`nginx`çš„`åå‘ä»£ç†`

#### CORS
`CORS`çš„å…¨ç§°æ˜¯"**è·¨åŸŸèµ„æºå…±äº«**"ï¼ˆCross-origin resource sharingï¼‰ã€‚ å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨ï¼Œå‘å‡º`XMLHttpRequest`è¯·æ±‚ï¼Œä»è€Œå…‹æœäº†`AJAX`åªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚

CORSæ˜¯æœåŠ¡å™¨éœ€è¦æ”¯æŒçš„ï¼Œåœ¨æœåŠ¡å™¨çš„å…¨å±€è®¿é—®ä¸‹åšä¸€å±‚æ‹¦æˆªï¼Œæ‰€æœ‰è®¿é—®éƒ½éœ€è¦å…ˆé€šè¿‡æ­¤æ‹¦æˆªå™¨ã€‚ä»¥`node.js`ä¸ºä¾‹ï¼Œå…·ä½“é…ç½®å¦‚ğŸ‘‡ï¼š
```javascript
res.header("Access-Control-Allow-Origin", reqUrl)
res.header("Access-Control-Allow-Headers", "X-Requested-With,Content-Type");
res.header("Access-Control-Allow-Methods", "PUT, POST, GET, DELETE,OPTIONS");
res.header("Access-Control-Allow-Credentials", true)
```

**Access-Control-Allow-Origin**
æ­¤å­—æ®µçš„æ„æ€æ˜¯å…è®¸å“ªäº›åŸŸåè®¿é—®æœåŠ¡å™¨å¯ä»¥æ­£å¸¸è¿”å›æ•°æ®ï¼Œå½“è®¾ç½®`*`æ—¶æ„ä¸ºæ‰€æœ‰è®¿é—®éƒ½å…è®¸è·¨åŸŸè®¿é—®æœåŠ¡å™¨ã€‚

**Access-Control-Allow-Headers**
å“åº”é¦–éƒ¨ `Access-Control-Allow-Headers` ç”¨äº `preflight request` ï¼ˆé¢„æ£€è¯·æ±‚ï¼‰ä¸­ï¼Œåˆ—å‡ºäº†å°†ä¼šåœ¨æ­£å¼è¯·æ±‚çš„ `Access-Control-Request-Headers` å­—æ®µä¸­å‡ºç°çš„é¦–éƒ¨ä¿¡æ¯ã€‚

**Access-Control-Allow-Methods**
å“åº”é¦–éƒ¨ `Access-Control-Allow-Methods` åœ¨å¯¹ `preflight request`.ï¼ˆé¢„æ£€è¯·æ±‚ï¼‰çš„åº”ç­”ä¸­æ˜ç¡®äº†å®¢æˆ·ç«¯æ‰€è¦è®¿é—®çš„èµ„æºå…è®¸ä½¿ç”¨çš„æ–¹æ³•æˆ–æ–¹æ³•åˆ—è¡¨ã€‚


**Access-Control-Allow-Credentials**
`Access-Control-Allow-Credentials` å“åº”å¤´è¡¨ç¤ºæ˜¯å¦å¯ä»¥å°†å¯¹è¯·æ±‚çš„å“åº”æš´éœ²ç»™é¡µé¢ã€‚è¿”å›trueåˆ™å¯ä»¥ï¼Œå…¶ä»–å€¼å‡ä¸å¯ä»¥ã€‚

**CORSç¼ºç‚¹**
æ— æ³•æ”¯æŒä½ç‰ˆæœ¬çš„`IE`æµè§ˆå™¨ï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–æ–¹æ³•ä»£æ›¿

#### JSONP
æˆ‘ä»¬åœ¨è·¨åŸŸçš„æ—¶å€™ç”±äºå½“å‰çš„æµè§ˆå™¨ä¸æ”¯æŒ CORS æˆ–è€…å› ä¸ºæŸäº›æ¡ä»¶ä¸æ”¯æŒ CORSï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼æ¥è·¨åŸŸï¼Œäºæ˜¯æˆ‘ä»¬å°±è¯·æ±‚ä¸€ä¸ª JS æ–‡ä»¶ï¼Œè¿™ä¸ª JS æ–‡ä»¶ä¼šæ‰§è¡Œä¸€ä¸ªå›è°ƒï¼Œå›è°ƒé‡Œé¢å°±æœ‰æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚

`JSONP`çš„å…¼å®¹æ€§ç›¸å¯¹`CORS`è€Œè¨€æ›´å¹¿

ä¸‹é¢å‰ç«¯ä»£ç çš„å®ç°
```javascript
function jsonp(url, jsonpCallback, success) {
    let script = document.createElement("script");
    script.src = url;
    script.async = true;
    script.type = "text/javascript";
    window[jsonpCallback] = function (data) {
        success && success(data);
    };
    document.body.appendChild(script);
}
jsonp(
    "http://127.0.0.1:3000/jsonp?callback=callback",
    "callback",
    function (value) {
        console.log(value);
    }
);

```

nodejsæœåŠ¡ç«¯å®ç°å¦‚ğŸ‘‡:
```javascript
const http = require('http') 
const urlModule = require('url')

const server = http.createServer()
server.on('request', function (req, res) {
  const { pathname: url, query } = urlModule.parse(req.url, true)
  if (url === '/jsonp') {
    var data = 'jsonp'

    var resp = `${query.callback}(${JSON.stringify(data)})`
    res.end(resp)
  } else {
    res.end('404')
  }
})

server.listen(3000, function () {
  console.log('server listen at http://127.0.0.1:3000')
})
```

#### åå‘ä»£ç†
åå‘ä»£ç†çš„åŸç†æ˜¯é€šè¿‡webæœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åé€šè¿‡è½¬å‘æ¥è¾¾åˆ°è·¨åŸŸè¯·æ±‚ä¸è¢«åŒæºç­–ç•¥é™åˆ¶çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚

åå‘ä»£ç†åˆ†å¯ä»¥ä¸º`å¼€å‘ç¯å¢ƒ`æ—¶å’Œ`çº¿ä¸Šç¯å¢ƒ`æ—¶ï¼Œå½“ä¸ºå¼€å‘æ—¶å¯ä»¥ä½¿ç”¨`webpack`çš„`devServer`å±æ€§ï¼Œè€Œåœ¨çº¿ä¸Šç¯å¢ƒåˆ™å¯ä»¥ä½¿ç”¨`nginx`çš„`location`å±æ€§ä½œä¸ºä»£ç†

**webpack config**
```javascript
 devServer: {
    // è®¾ç½®ä¸»æœºåœ°å€
    host: '0.0.0.0',
    // è®¾ç½®é»˜è®¤ç«¯å£
    port: port,
    https: false,
    proxy: {
        '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
        pathRewrite: {
        '^/api': '',
        },
    secure: false,
  }
```
**nginx config**

```conf
location / {
    proxy_pass http://localhost:8000;
}
```



